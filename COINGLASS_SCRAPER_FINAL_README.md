# Coinglass BTC-USDT Order Book Scraper - Final Version

## 概要
実際のCoinglass.comのページ構造を分析した後に作成した、正確な板情報取得ツールです。
売り板と買い板の総量をリアルタイムで集計して表示します。

## 主な機能
- **板情報の自動集計**: 個別の注文を自動的に売り板・買い板に分類して集計
- **現在価格の表示**: リアルタイムの現在価格を取得・表示
- **買い/売り比率**: 板の偏りを数値で表示
- **差額表示**: 買い板と売り板の差額を表示
- **データエクスポート**: JSON/CSV形式でデータを保存
- **ヘッドレスモード**: バックグラウンドで実行可能

## ファイル一覧
1. **coinglass_scraper_final.py** - 最終版のメインプログラム
2. **run_scraper_final.bat** - 実行用バッチファイル
3. **page_analyzer.py** - ページ構造分析ツール（開発時に使用）
4. **run_analyzer.bat** - 分析ツール実行用

## セットアップと実行

### 初回セットアップ
1. `setup_scraper.bat`を実行（必要なライブラリをインストール）

### アプリケーションの実行
1. `run_scraper_final.bat`をダブルクリック
2. GUIが起動したら「開始」ボタンをクリック

## 使い方

### 基本操作
- **開始**: スクレイピングを開始（板情報の取得を開始）
- **停止**: スクレイピングを停止
- **スクリーンショット**: 現在のページをキャプチャ
- **データエクスポート**: 収集したデータをJSON/CSV形式で保存

### 表示される情報
- **現在価格**: BTC/USDTの現在価格
- **売り板総量**: 現在価格より高い注文の合計数量
- **買い板総量**: 現在価格より低い注文の合計数量
- **買い/売り比率**: 買い板÷売り板の比率（1.0以上で買い優勢）
- **差額**: 買い板総量 - 売り板総量

### 設定オプション
- **更新間隔**: 1〜60秒で調整可能
- **ヘッドレスモード**: チェックするとブラウザを表示せずに実行

## データの見方

### 買い/売り比率の解釈
- **1.0以上（緑色）**: 買い圧力が強い（上昇圧力）
- **1.0未満（赤色）**: 売り圧力が強い（下落圧力）

### エクスポートデータ
- **JSON形式**: すべての取得データを含む詳細情報
- **CSV形式**: Excel等で分析しやすい表形式データ

## トラブルシューティング

### 板情報が取得できない場合
1. インターネット接続を確認
2. Coinglass.comにアクセスできるか確認
3. ヘッドレスモードをOFFにして動作を確認
4. ログを確認して詳細なエラーを把握

### ChromeDriverエラーの場合
1. Google Chromeを最新版に更新
2. `setup_scraper.bat`を再実行
3. それでも動作しない場合は手動でChromeDriverをダウンロード

## 技術仕様
- **データ取得方法**: JavaScriptで板情報要素を解析し、現在価格を基準に分類
- **更新頻度**: ユーザー設定可能（デフォルト5秒）
- **データ保持**: メモリ上に最新1000件を保持

## 注意事項
- サーバーへの負荷を考慮し、更新間隔は適切に設定してください
- 取得データの利用は自己責任でお願いします
- ページ構造が変更された場合は動作しない可能性があります

## バージョン履歴
- **Final Version**: 実際のページ構造に基づく正確な実装
- **v3**: ChromeDriver問題の修正
- **v2**: 複数の抽出方法を実装
- **v1**: 初期版